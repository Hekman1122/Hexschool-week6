"use strict";(self["webpackChunkhex_week6"]=self["webpackChunkhex_week6"]||[]).push([[70],{740:function(t,e,a){function l(t){return{all:t=t||new Map,on:function(e,a){var l=t.get(e);l?l.push(a):t.set(e,[a])},off:function(e,a){var l=t.get(e);l&&(a?l.splice(l.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var l=t.get(e);l&&l.slice().map((function(t){t(a)})),(l=t.get("*"))&&l.slice().map((function(t){t(e,a)}))}}}a.d(e,{Z:function(){return i}});const s=l();var i=s},70:function(t,e,a){a.r(e),a.d(e,{default:function(){return z}});var l=a(252),s=a(577),i=a(963);const n=t=>((0,l.dD)("data-v-50447604"),t=t(),(0,l.Cn)(),t),r={class:"carts"},u=n((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"圖片"),(0,l._)("th",null,"產品名稱"),(0,l._)("th",null,"售價"),(0,l._)("th",null,"調整數量"),(0,l._)("th",null,"調整產品")])],-1))),o=["src"],d=["onUpdate:modelValue","onChange"],c=["value"],h={for:"amount"},m=["onClick"],p={colspan:"5"},_={class:"form-page"},f=n((()=>(0,l._)("h2",null,"使用者登入",-1))),g={class:"input-box"},b=n((()=>(0,l._)("label",{for:"email"},"信箱",-1))),v={class:"input-box"},C=n((()=>(0,l._)("label",{for:"fullName"},"姓名",-1))),w={class:"input-box"},y=n((()=>(0,l._)("label",{for:"cellphone"},"電話",-1))),$={class:"input-box"},V=n((()=>(0,l._)("label",{for:"address"},"住址",-1))),x=n((()=>(0,l._)("div",{class:"input-box"},[(0,l._)("label",{for:"message"},"留言"),(0,l._)("textarea",{id:"message",cols:"48",rows:"10"})],-1))),k=n((()=>(0,l._)("div",{class:"input-box"},[(0,l._)("button",{type:"submit"},"送出")],-1)));function D(t,e,a,n,D,q){const W=(0,l.up)("FieldView"),L=(0,l.up)("ErrorMessage"),U=(0,l.up)("FormView");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("button",{type:"button",onClick:e[0]||(e[0]=(...t)=>q.deleteAll&&q.deleteAll(...t)),class:(0,s.C_)({disable:0===D.cartData.final_total})}," 清空購物車 ",2),(0,l._)("table",null,[u,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(D.cartData.carts,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,[(0,l._)("img",{src:t.product.imageUrl},null,8,o)]),(0,l._)("td",null,(0,s.zw)(t.product.title),1),(0,l._)("td",null,(0,s.zw)(t.final_total),1),(0,l._)("td",null,[(0,l.wy)((0,l._)("select",{name:"amount","onUpdate:modelValue":e=>t.qty=e,onChange:e=>q.updateCartItem(t)},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(100,(t=>(0,l._)("option",{value:t,key:t},(0,s.zw)(t),9,c))),64))],40,d),[[i.bM,t.qty]]),(0,l._)("label",h,(0,s.zw)(t.qty+t.product.unit),1)]),(0,l._)("td",null,[(0,l._)("i",{class:"far fa-trash-alt",onClick:e=>q.deleCartItem(t.id)},null,8,m)])])))),128))]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[(0,l._)("td",p,[(0,l._)("h3",null,"總計 : "+(0,s.zw)(D.cartData.final_total)+" 元",1)])])])]),(0,l._)("div",null,[(0,l._)("button",{type:"button",class:(0,s.C_)({disable:0===D.cartData.final_total}),onClick:e[1]||(e[1]=t=>q.payCheck(t))}," 結帳 ",2)])]),(0,l._)("div",_,[f,(0,l.Wm)(U,{ref:"form",onSubmit:q.login},{default:(0,l.w5)((()=>[(0,l._)("div",g,[b,(0,l.Wm)(W,{id:"email",name:"信箱",type:"email",placeholder:"請輸入信箱",rules:"email|required",modelValue:D.user.email,"onUpdate:modelValue":e[2]||(e[2]=t=>D.user.email=t)},null,8,["modelValue"]),(0,l.Wm)(L,{name:"信箱"})]),(0,l._)("div",v,[C,(0,l.Wm)(W,{id:"fullName",name:"姓名",type:"text",placeholder:"請輸入姓名",rules:"required",modelValue:D.user.name,"onUpdate:modelValue":e[3]||(e[3]=t=>D.user.name=t)},null,8,["modelValue"]),(0,l.Wm)(L,{name:"姓名"})]),(0,l._)("div",w,[y,(0,l.Wm)(W,{id:"cellphone",name:"電話",type:"tel",placeholder:"請輸入電話",rules:"min:8|required|max:12",modelValue:D.user.tel,"onUpdate:modelValue":e[4]||(e[4]=t=>D.user.tel=t)},null,8,["modelValue"]),(0,l.Wm)(L,{name:"電話"})]),(0,l._)("div",$,[V,(0,l.Wm)(W,{id:"address",name:"住址",type:"text",placeholder:"請輸入住址",rules:"required",modelValue:D.user.address,"onUpdate:modelValue":e[5]||(e[5]=t=>D.user.address=t)},null,8,["modelValue"]),(0,l.Wm)(L,{name:"住址"})]),x,k])),_:1},8,["onSubmit"])])],64)}var q=a(740),W={data(){return{url:"https://vue3-course-api.hexschool.io/v2",path:"hexschoolforhenrywu",cartData:{},user:{}}},computed:{userData(){return{user:this.user}}},methods:{getCarts(){this.$http.get(`${this.url}/api/${this.path}/cart`).then((t=>{this.cartData=t.data.data})).catch((t=>{console.dir(t)}))},login(){alert(`${this.user.name} 歡迎您!`),this.$refs.form.resetForm()},deleCartItem(t){this.isLoading=t,this.$http.delete(`${this.url}/api/${this.path}/cart/${t}`).then((t=>{alert("該商品已刪除"),q.Z.emit("cart-change"),this.getCarts(),this.isLoading=""})).catch((t=>{console.dir(t)}))},updateCartItem(t){const e={product_id:t.id,qty:t.qty};this.isLoading=t.id,this.$http.put(`${this.url}/api/${this.path}/cart/${t.id}`,{data:e}).then((t=>{this.getCarts(),this.isLoading=""}))},deleteAll(){this.$http.delete(`${this.url}/api/${this.path}/carts`).then((t=>{alert("商品已全部刪除"),q.Z.emit("cart-change"),this.getCarts()})).catch((t=>{console.dir(t)}))},payCheck(t){if(this.user.name){const e={...this.userData};t.target.classList.add("disable"),this.$http.post(`${this.url}/api/${this.path}/order`,{data:e}).then((e=>{alert("結帳成功!"),t.target.classList.remove("disable"),q.Z.emit("cart-change"),this.getCarts()})).catch((t=>{console.dir(t.data.message)}))}else alert("請先登入"),t.target.classList.remove("disable")}},mounted(){this.getCarts()}},L=a(744);const U=(0,L.Z)(W,[["render",D],["__scopeId","data-v-50447604"]]);var z=U}}]);
//# sourceMappingURL=70.57afdf82.js.map